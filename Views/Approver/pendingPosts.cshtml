@model IEnumerable<SEP.Models.DomainModels.Post>
@{
	ViewData["Title"] = "Pending Job Posts";
}
<h2>Pending Job Posts</h2>
<hr />
<div>
	@if (Model.Count() > 0)
	{
		<div>
			<table id="postTable" class="table table-bordered" style="width:100%">
				<thead>
					<tr>
						<th>
							Job title
						</th>
						<th>
							Department
						</th>
						<th>
							Job type
						</th>
						<th>
							Start date
						</th>
						<th>
							End date
						</th>
						<th>
							Status
						</th>
						<th></th>
					</tr>
				</thead>
				<tbody>
					@*@foreach (var post in Model)
					{
						<tr>
							<td width="15%">
								@post.JobTitle
							</td>
							<td width="20%">
								@post.DepartmentName
							</td>
							<td width="15%">
								@post.JobType
							</td>
							<td width="15%">
								@post.StartDate.ToString("d")
							</td>
							<td width="15%">
								@post.EndDate.ToString("d")
							</td>
							<td width="20%">
								<div class="row">
									<div class="col">
										@post.ApprovalStatus
									</div>
									<div class="col">
										<a asp-controller="Approver" asp-action="ApproverUpdatePost" asp-route-id="@post.PostId" class="btn btn-info btn-sm" value="">Review</a>
									</div>

								</div>
							</td>
						</tr>
					}*@
				</tbody>
			</table>
		</div>
	}
	else
	{
		<p>There are no job posts awaiting approval.</p>
	}
</div>
<div>
	<a asp-controller="Home" asp-action="ApproverHome" class="btn btn-secondary">Back</a>
</div>

@section Scripts{
	<script>
		$(document).ready(function () {

			LoadList();
		});

		function LoadList() {
			var postData = [];
			$.ajax({
				type: "GET",
				url: "/Approver/GetPendingPosts",
				async: false,
				success: function (data) {
					$.each(data, function (key, value) {
						var reviewBtn = "<a class='btn btn-info btn-sm' href='/Approver/ApproverUpdatePost/" + value.postId + "'>Review</a>";
						var hdn = "<input type='hidden' value=" + value.postId + "/>";
						var action = reviewBtn + hdn;
						var startDate = new Date(value.startDate);
						var formattedStartDate = startDate.toDateString();
						var endDate = new Date(value.endDate);
						var formattedEndDate = endDate.toDateString();
						postData.push([value.jobTitle, value.departmentName, value.jobType, formattedStartDate, formattedEndDate, value.postStatus, action])
					});
				},
				failure: function (error) {

				}
			});
			$('#postTable').DataTable({
				data: postData
			});
		}
	</script>
}



